<template>
    <div class="pipeline-container">
        <!-- Enquiry Inner Screen View -->
        <template if:true={showEnquiryInnerScreen}>
            <c-enquirey-inner-screen 
                enquiry-id={currentEnquiryId}
                onback={handleBackToList}>
            </c-enquirey-inner-screen>
        </template>

        <!-- Main Pipeline Master View -->
        <template if:false={showEnquiryInnerScreen}>
            <!-- Horizontal Tabs - Outside table container -->
        <div class="tabs-wrapper slds-m-top_medium">
            <ul class="horizontal-tabs-list" role="tablist">
                <li class={healthSystemsClass} role="presentation">
                    <a href="javascript:void(0);" 
                       role="tab"
                       data-tab="healthSystems"
                       onclick={handleTabClick}
                       aria-selected={isHealthSystems}
                       class="tab-link">
                        Health Systems
                    </a>
                </li>
                <li class={sponsorsClass} role="presentation">
                    <a href="javascript:void(0);" 
                       role="tab"
                       data-tab="sponsors"
                       onclick={handleTabClick}
                       aria-selected={isSponsors}
                       class="tab-link">
                        Sponsors
                    </a>
                </li>
                <li class={enquiriesClass} role="presentation">
                    <a href="javascript:void(0);" 
                       role="tab"
                       data-tab="enquiries"
                       onclick={handleTabClick}
                       aria-selected={isEnquiries}
                       class="tab-link">
                        Enquiries
                    </a>
                </li>
            </ul>
        </div>

        <!-- Content Area -->
        <div class="content-wrapper slds-m-top_small">
            <div class="slds-card">
                <!-- Action Bar -->
                <div class="slds-card__header slds-grid">
                    <div class="slds-media slds-media_center slds-has-flexi-truncate">
                        <div class="slds-media__body">
                            <h2 class="slds-card__header-title">
                                <template if:true={isHealthSystems}>
                                    <span>Health Systems</span>
                                </template>
                                <template if:true={isSponsors}>
                                    <span>Sponsors</span>
                                </template>
                                <template if:true={isEnquiries}>
                                    <span>Enquiries</span>
                                </template>
                                <template if:true={isProjects}>
                                    <span>Projects</span>
                                </template>
                            </h2>
                        </div>
                    </div>
                    <div class="slds-no-flex">
                        <div class="action-buttons-separated" style="display: flex; align-items: center; gap: 12px;">
                            <lightning-input 
                                type="search" 
                                placeholder="Search..." 
                                variant="label-hidden"
                                style="width: 250px;">
                            </lightning-input>
                            <button class="btn-filter-toggle"
                                style="background-color: #f4f6f9; color: #16325c; border: 1px solid #d8dde6; border-radius: 4px; padding: 6px 14px;"
                                onclick={handleFilter}>
                                <span class="filter-icon-wrapper"><lightning-icon icon-name="utility:filterList" size="x-small"></lightning-icon></span>
                                <span class="filter-label" style="margin-left: 8px;">Filter</span>
                            </button>
                            <button class="btn-filter-toggle"
                                style="background-color: #2e37a4 !important; color: white !important; border: none; border-radius: 4px; padding: 6px 14px; position: relative;"
                                onclick={handleAdd}>
                                <span
                                    style="color: white; font-size: 1.5rem; position: absolute; top: 41%; left: 25%; transform: translate(-50%, -50%);"><b>+</b></span>
                                <span style="color: white; margin-left: 1.5rem;"><b>Add</b></span>
                            </button>
                        </div>
                    </div>
                </div>
        
                <!-- Filter Section (collapsible) -->
                <template if:true={showFilters}>
                    <div class="custom-filter-panel">
                        <div class="filter-header">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <h4>Filter</h4>
                                <a onclick={clearAllFilters}>Clear All</a>
                            </div>
                        </div>
                        <div class="filter-body">
                            <div class="filter-grid">
                                
                                <!-- Search Filter -->
                                <!-- <div class="filter-item">
                                    <div class="filter-item-header">
                                        <label class="form-label">Search</label>
                                    </div>
                                    <lightning-input type="search" placeholder="Search..." variant="label-hidden"></lightning-input>
                                </div> -->

                                <!-- Status Filter -->
                                <div class="filter-item">
                                    <div class="filter-item-header">
                                        <label class="form-label">Status</label>
                                    </div>
                                    <div class="dropdown-container">
                                        <button class="dropdown-btn" onclick={toggleStatusDropdown}>
                                            <span>{statusDisplayText}</span>
                                            <span class="chevron">▼</span>
                                        </button>
                                        <div class={statusDropdownClass}>
                                            <ul class="dropdown-options">
                                                <template for:each={statusOptions} for:item="opt">
                                                    <li key={opt.value}>
                                                        <label>
                                                            <input type="checkbox" value={opt.value} checked={opt.checked}
                                                                onchange={handleStatusCheckboxChange}>
                                                            {opt.label}
                                                        </label>
                                                    </li>
                                                </template>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- City Filter -->
                                <div class="filter-item">
                                    <div class="filter-item-header">
                                        <label class="form-label">City</label>
                                    </div>
                                    <div class="dropdown-container">
                                        <button class="dropdown-btn" onclick={toggleCityDropdown}>
                                            <span>{cityDisplayText}</span>
                                            <span class="chevron">▼</span>
                                        </button>
                                        <div class={cityDropdownClass}>
                                            <ul class="dropdown-options">
                                                <template for:each={cityOptions} for:item="opt">
                                                    <li key={opt.value}>
                                                        <label>
                                                            <input type="checkbox" value={opt.value} checked={opt.checked}
                                                                onchange={handleCityCheckboxChange}>
                                                            {opt.label}
                                                        </label>
                                                    </li>
                                                </template>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- State Filter -->
                                <div class="filter-item">
                                    <div class="filter-item-header">
                                        <label class="form-label">State</label>
                                    </div>
                                    <div class="dropdown-container">
                                        <button class="dropdown-btn" onclick={toggleStateDropdown}>
                                            <span>{stateDisplayText}</span>
                                            <span class="chevron">▼</span>
                                        </button>
                                        <div class={stateDropdownClass}>
                                            <ul class="dropdown-options">
                                                <template for:each={stateOptions} for:item="opt">
                                                    <li key={opt.value}>
                                                        <label>
                                                            <input type="checkbox" value={opt.value} checked={opt.checked}
                                                                onchange={handleStateCheckboxChange}>
                                                            {opt.label}
                                                        </label>
                                                    </li>
                                                </template>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                        <div class="filter-footer">
                            <div class="footer-actions">
                                <a class="btn-close" onclick={closeFilter}>Close</a>
                                <button class="btn-filter" onclick={applyFilter}>Filter</button>
                            </div>
                        </div>
                    </div>
                </template>
        
                <!-- Table Content -->
                <div class="slds-card__body slds-card__body_inner table-container">
                    <!-- Health Systems Table -->
                    <template if:true={isHealthSystems}>
                        <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                            <thead>
                                <tr class="slds-line-height_reset" style="height: 36px;">
                                    <th scope="col" style="width: 120px; padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate">Actions</div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="id" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>HS ID</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="name" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>HS Name</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="status" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Status</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="city" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>City</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="state" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>State</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="contact" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Contact Person</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="email" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Email ID</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="phone" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Phone</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="lastUpdated" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Last Updated</span>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={currentData} for:item="record">
                                    <tr key={record.id} class="slds-hint-parent">
                                        <td>
                                            <div class="action-buttons-cell">
                                                <lightning-button-icon icon-name="utility:edit" alternative-text="Edit"
                                                    title="Edit" variant="bare" class="edit-icon" data-id={record.id}
                                                    onclick={handleEdit}>
                                                </lightning-button-icon>
                                                <lightning-button-icon icon-name="utility:delete" alternative-text="Delete"
                                                    title="Delete" variant="bare" class="delete-icon" data-id={record.id}
                                                    onclick={handleDelete}>
                                                </lightning-button-icon>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.id}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate name-with-avatar">
                                                <span class="profile-avatar">{record.nameInitial}</span>
                                                <span>{record.name}</span>
                                            </div>
                                        </td>
                                        <td class="status-cell">
                                            <span class={record.statusClass}>{record.status}</span>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.city}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.state}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate name-with-avatar">
                                                <span class="profile-avatar">{record.contactInitial}</span>
                                                <span>{record.contact}</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.email}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.phone}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.lastUpdated}</div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </template>
        
                    <!-- Sponsors Table -->
                    <template if:true={isSponsors}>
                        <table class="slds-table slds-table_bordered slds-table_cell-buffer">
                            <thead>
                                <tr class="slds-line-height_reset" style="height: 36px;">
                                    <th scope="col" style="width: 120px; padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate">Actions</div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="id" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Sponsor ID</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="name" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Sponsor Name</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="status" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Status</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="city" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>City</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="state" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>State</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="contact" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Contact Person</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="email" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Email ID</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="phone" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Phone</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="lastUpdated" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Last Updated</span>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={currentData} for:item="record">
                                    <tr key={record.id} class="slds-hint-parent">
                                        <td>
                                            <div class="action-buttons-cell">
                                                <lightning-button-icon icon-name="utility:edit" alternative-text="Edit"
                                                    title="Edit" variant="bare" class="edit-icon" data-id={record.id}
                                                    onclick={handleEdit}>
                                                </lightning-button-icon>
                                                <lightning-button-icon icon-name="utility:delete" alternative-text="Delete"
                                                    title="Delete" variant="bare" class="delete-icon" data-id={record.id}
                                                    onclick={handleDelete}>
                                                </lightning-button-icon>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.id}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate name-with-avatar">
                                                <span class="profile-avatar">{record.nameInitial}</span>
                                                <span>{record.name}</span>
                                            </div>
                                        </td>
                                        <td class="status-cell">
                                            <span class={record.statusClass}>{record.status}</span>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.city}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.state}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate name-with-avatar">
                                                <span class="profile-avatar">{record.contactInitial}</span>
                                                <span>{record.contact}</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.email}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.phone}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.lastUpdated}</div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </template>
        
                    <!-- Enquiries Table -->
                    <template if:true={isEnquiries}>
                        <table class="slds-table slds-table_bordered slds-table_cell-buffer table-rounded enquiries-table">
                            <thead>
                                <tr class="slds-line-height_reset" style="height: 36px;">
                                    <th scope="col" style="width: 120px; padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate">Actions</div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="enquiryId" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Enquiry ID</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="status" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Enquiry Status</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="sponsorName" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Sponsor Name</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="projectName" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Project Name</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="projectDetails" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Project Details</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="projectScopingDoc" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Project Scoping Doc</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="hsAllocated" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>HS Allocated</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="dateCreated" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Date Created</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="lastUpdated" onclick={handleSort} style="padding-top: 4px; padding-bottom: 4px;">
                                        <div class="slds-truncate header-content">
                                            <span>Last Updated</span>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={currentData} for:item="record">
                                    <tr key={record.id} class="slds-hint-parent">
                                        <td>
                                            <div class="action-buttons-cell">
                                                <lightning-button-icon icon-name="utility:edit" alternative-text="Edit"
                                                    title="Edit" variant="bare" class="edit-icon" data-id={record.id}
                                                    onclick={handleEdit}>
                                                </lightning-button-icon>
                                                <lightning-button-icon icon-name="utility:delete" alternative-text="Delete"
                                                    title="Delete" variant="bare" class="delete-icon" data-id={record.id}
                                                    onclick={handleDelete}>
                                                </lightning-button-icon>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">
                                                <a href="javascript:void(0);"
                                                    style="color: #0176d3; font-weight: 600; text-decoration: none; cursor: pointer;"
                                                    data-id={record.id} onclick={handleEnquiryClick}>{record.enquiryId}</a>
                                            </div>
                                        </td>
                                        <td class="status-cell">
                                            <span class={record.statusClass}>{record.status}</span>
                                        </td>
                                        <td>
                                            <div class="slds-truncate name-with-avatar">
                                                <span class="profile-avatar">{record.sponsorInitial}</span>
                                                <span>{record.sponsorName}</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.projectName}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.projectDetails}</div>
                                        </td>
                                            <td style="text-align:center;">
                                                <template if:true={record.hasDocument}>
                                                    <span style="color: #0176d3; cursor: pointer; font-weight: 600; text-align:center;">View</span>
                                                </template>
                                                <template if:false={record.hasDocument}>
                                                    <span style="color: #706e6b; text-align:center;">-</span>
                                                </template>
                                            </td>
                                        <td>
                                            <div class="slds-truncate">{record.hsAllocated}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.dateCreated}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.lastUpdated}</div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </template>
        
                    <!-- Projects Table -->
                    <template if:true={isProjects}>
                        <table class="slds-table slds-table_bordered slds-table_cell-buffer table-rounded">
                            <thead>
                                <tr class="slds-line-height_reset">
                                    <th scope="col" style="width: 120px;">
                                        <div class="slds-truncate">Actions</div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="projectId" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Project ID</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="projectName" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Project Name</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="status" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Project Status</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="completion" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Completion</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="sponsorName" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Sponsor</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="healthSystemName" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>HS</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="documents" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Documents</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="notes" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Notes</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="messages" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Messages</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="lastUpdated" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Last Updated</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="state" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>State</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="city" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>City</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="contact" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Contact</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="email" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Email</span>
                                        </div>
                                    </th>
                                    <th scope="col" class="sortable-header" data-field="phone" onclick={handleSort}>
                                        <div class="slds-truncate header-content">
                                            <span>Phone</span>
                                        </div>
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <template for:each={currentData} for:item="record">
                                    <tr key={record.projectId} class="slds-hint-parent">
                                        <td>
                                            <div class="action-buttons-cell">
                                                <lightning-button-icon icon-name="utility:edit" alternative-text="Edit"
                                                    title="Edit" variant="bare" class="edit-icon" data-id={record.projectId}
                                                    onclick={handleEdit}>
                                                </lightning-button-icon>
                                                <lightning-button-icon icon-name="utility:delete" alternative-text="Delete"
                                                    title="Delete" variant="bare" class="delete-icon" data-id={record.projectId}
                                                    onclick={handleDelete}>
                                                </lightning-button-icon>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.projectId}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.projectName}</div>
                                        </td>
                                        <td class="status-cell">
                                            <span class={record.statusClass}>{record.status}</span>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.completion}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate name-with-avatar">
                                                <span class="profile-avatar">{record.sponsorInitial}</span>
                                                <span>{record.sponsorName}</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate name-with-avatar">
                                                <span class="profile-avatar">{record.hsInitial}</span>
                                                <span>{record.healthSystemName}</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.documents}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.notes}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.messages}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.lastUpdated}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.state}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.city}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate name-with-avatar">
                                                <span class="profile-avatar">{record.contactInitial}</span>
                                                <span>{record.contact}</span>
                                            </div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.email}</div>
                                        </td>
                                        <td>
                                            <div class="slds-truncate">{record.phone}</div>
                                        </td>
                                    </tr>
                                </template>
                            </tbody>
                        </table>
                    </template>
                </div>
        
                <!-- Pagination Footer -->
                <div>
                    <div class="pagination-container-right">
                        <c-paginator total-size={totalSize} page-size={pageSize} page-index={pageIndex}
                            page-size-options={pageSizeOptions} onpagechange={handlePageChange}>
                        </c-paginator>
                    </div>
                </div>
            </div>
        </div>
        
        </template>

    <!-- Requirements and HS Matches modals removed -->
    </div>
</template>